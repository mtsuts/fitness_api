import React, { useState } from "react";
import Map, { Source, Layer } from "react-map-gl";
import "mapbox-gl/dist/mapbox-gl.css";

const mapboxApi =
  "pk.eyJ1IjoibXRzdXRzIiwiYSI6ImNtMWxuemNiMTA3dW8ya3EzaTZ3OXJvbXgifQ.89CjEa8b7-RrRdrIrv83nA";

const polylineTest = [
  [
    ["47.62966", "-122.34061"],
    ["47.62937", "-122.34055"],
    ["47.62906", "-122.34055"],
    ["47.6289", "-122.34051"],
    ["47.62818", "-122.34005"],
    ["47.62793", "-122.33991"],
    ["47.62781", "-122.33979"],
    ["47.62745", "-122.33962"],
    ["47.62736", "-122.33967"],
    ["47.62688", "-122.33964"],
    ["47.62686", "-122.33969"],
    ["47.6267", "-122.33984"],
    ["47.62655", "-122.33994"],
    ["47.626", "-122.33987"],
    ["47.62551", "-122.33988"],
    ["47.62545", "-122.33983"],
    ["47.62515", "-122.33971"],
    ["47.62497", "-122.33959"],
    ["47.62483", "-122.33965"],
    ["47.62481", "-122.33963"],
    ["47.62481", "-122.33959"],
    ["47.62442", "-122.33966"],
    ["47.62431", "-122.33964"],
    ["47.62421", "-122.33958"],
    ["47.6238", "-122.33973"],
    ["47.62357", "-122.33977"],
    ["47.6232", "-122.33977"],
    ["47.62217", "-122.33959"],
    ["47.62164", "-122.33959"],
    ["47.6214", "-122.33952"],
    ["47.62116", "-122.33957"],
    ["47.62095", "-122.33957"],
    ["47.62087", "-122.33954"],
    ["47.62052", "-122.33962"],
    ["47.62042", "-122.3396"],
    ["47.61995", "-122.34008"],
    ["47.61945", "-122.34031"],
    ["47.61935", "-122.3403"],
    ["47.61911", "-122.34013"],
    ["47.61876", "-122.3402"],
    ["47.61917", "-122.3396"],
    ["47.61887", "-122.33972"],
    ["47.61863", "-122.33974"],
    ["47.61848", "-122.33993"],
    ["47.61836", "-122.34001"],
    ["47.6182", "-122.34034"],
    ["47.61804", "-122.34051"],
    ["47.61792", "-122.34058"],
    ["47.61785", "-122.3407"],
    ["47.61759", "-122.34098"],
    ["47.61747", "-122.34103"],
    ["47.61738", "-122.34098"],
    ["47.61742", "-122.34103"],
    ["47.61739", "-122.34104"],
    ["47.6174", "-122.34099"],
    ["47.61735", "-122.34109"],
    ["47.61733", "-122.3412"],
    ["47.6171", "-122.34136"],
    ["47.61687", "-122.34177"],
    ["47.61671", "-122.3422"],
    ["47.61654", "-122.34241"],
    ["47.61645", "-122.34267"],
    ["47.61618", "-122.34288"],
    ["47.61589", "-122.3432"],
    ["47.61573", "-122.34326"],
    ["47.61559", "-122.3434"],
    ["47.61537", "-122.34379"],
    ["47.61539", "-122.34386"],
    ["47.61521", "-122.34409"],
    ["47.61507", "-122.34435"],
    ["47.61488", "-122.34459"],
    ["47.61479", "-122.34477"],
    ["47.61438", "-122.34519"],
    ["47.61429", "-122.34529"],
    ["47.61418", "-122.34548"],
    ["47.61407", "-122.34561"],
    ["47.61409", "-122.34555"],
    ["47.61401", "-122.3455"],
    ["47.61396", "-122.34543"],
    ["47.61379", "-122.34515"],
    ["47.61361", "-122.34482"],
    ["47.61353", "-122.34461"],
    ["47.61335", "-122.34448"],
    ["47.6133", "-122.34441"],
    ["47.61316", "-122.34416"],
    ["47.61302", "-122.34395"],
    ["47.61289", "-122.34368"],
    ["47.61272", "-122.34357"],
    ["47.61266", "-122.34356"],
    ["47.61263", "-122.34337"],
    ["47.61242", "-122.34323"],
    ["47.61236", "-122.34311"],
    ["47.61233", "-122.34294"],
    ["47.61202", "-122.34265"],
    ["47.61188", "-122.34236"],
    ["47.61167", "-122.34223"],
    ["47.61177", "-122.34177"],
    ["47.61185", "-122.34178"],
    ["47.6117", "-122.34163"],
    ["47.61139", "-122.34141"],
    ["47.61131", "-122.34131"],
    ["47.61114", "-122.34091"],
    ["47.61095", "-122.34067"],
    ["47.61086", "-122.34045"],
    ["47.61066", "-122.34039"],
    ["47.61044", "-122.34028"],
    ["47.61035", "-122.34023"],
    ["47.61034", "-122.34018"],
    ["47.6102", "-122.34011"],
    ["47.61015", "-122.34001"],
    ["47.61011", "-122.34001"],
    ["47.61007", "-122.33996"],
    ["47.60999", "-122.34"],
    ["47.60968", "-122.33952"],
    ["47.60937", "-122.33938"],
    ["47.60936", "-122.33916"],
    ["47.60929", "-122.33902"],
    ["47.60927", "-122.33901"],
    ["47.60921", "-122.33908"],
    ["47.60918", "-122.33904"],
    ["47.60917", "-122.33897"],
    ["47.60895", "-122.33878"],
    ["47.60879", "-122.33855"],
    ["47.60859", "-122.33841"],
    ["47.60845", "-122.33826"],
    ["47.60825", "-122.33813"],
    ["47.60793", "-122.33808"],
    ["47.60763", "-122.33797"],
    ["47.60759", "-122.33793"],
    ["47.60757", "-122.33784"],
    ["47.60758", "-122.33748"],
    ["47.60744", "-122.33729"],
    ["47.60726", "-122.33688"],
    ["47.60724", "-122.33688"],
    ["47.60731", "-122.33713"],
    ["47.60725", "-122.33713"],
    ["47.6071", "-122.33737"],
    ["47.60739", "-122.33717"],
    ["47.60744", "-122.33721"],
    ["47.60748", "-122.33742"],
    ["47.60746", "-122.33747"],
    ["47.60748", "-122.33751"],
    ["47.60739", "-122.33751"],
    ["47.6073", "-122.33762"],
    ["47.60722", "-122.33766"],
    ["47.60695", "-122.33791"],
    ["47.60678", "-122.33777"],
    ["47.60671", "-122.33764"],
    ["47.60665", "-122.33759"],
    ["47.60669", "-122.33759"],
    ["47.60677", "-122.33767"],
    ["47.60672", "-122.33759"],
    ["47.60669", "-122.3376"],
    ["47.60673", "-122.3375"],
    ["47.60666", "-122.33758"],
    ["47.60661", "-122.33758"],
    ["47.60678", "-122.33767"],
    ["47.60683", "-122.33767"],
    ["47.60683", "-122.33765"],
    ["47.60685", "-122.33763"],
    ["47.60684", "-122.33784"],
    ["47.60478", "-122.33963"],
    ["47.60481", "-122.33961"],
    ["47.60482", "-122.33964"],
    ["47.60487", "-122.33967"],
    ["47.60491", "-122.34014"],
    ["47.60498", "-122.34019"],
    ["47.60496", "-122.34022"],
    ["47.60501", "-122.34019"],
    ["47.60503", "-122.34003"],
    ["47.60502", "-122.33986"],
    ["47.60499", "-122.33978"],
    ["47.60494", "-122.33973"],
    ["47.60481", "-122.33965"],
    ["47.60483", "-122.33968"],
    ["47.60479", "-122.33969"],
    ["47.60478", "-122.33961"],
    ["47.60499", "-122.34017"],
    ["47.60504", "-122.34018"],
    ["47.60517", "-122.34013"],
    ["47.60521", "-122.34006"],
    ["47.60525", "-122.34005"],
    ["47.60543", "-122.34015"],
    ["47.60571", "-122.34041"],
    ["47.60586", "-122.34051"],
    ["47.60584", "-122.34051"],
    ["47.60585", "-122.34053"],
    ["47.60593", "-122.34027"],
    ["47.60591", "-122.34026"],
    ["47.6058", "-122.34047"],
    ["47.60582", "-122.34052"],
    ["47.60585", "-122.3405"],
    ["47.60584", "-122.34047"],
    ["47.60584", "-122.34055"],
    ["47.60587", "-122.34055"],
    ["47.60587", "-122.34049"],
    ["47.60594", "-122.34028"],
    ["47.60596", "-122.34028"],
    ["47.60593", "-122.34035"],
    ["47.60576", "-122.34063"],
    ["47.60579", "-122.34055"],
    ["47.606", "-122.34063"],
    ["47.60656", "-122.34116"],
    ["47.60695", "-122.34149"],
    ["47.60715", "-122.34174"],
    ["47.60724", "-122.34191"],
    ["47.60733", "-122.34205"],
    ["47.60748", "-122.34233"],
    ["47.60786", "-122.34298"],
    ["47.60795", "-122.34312"],
    ["47.60816", "-122.34333"],
    ["47.60829", "-122.34355"],
    ["47.6083", "-122.34369"],
    ["47.60837", "-122.34376"],
    ["47.60846", "-122.34399"],
    ["47.60843", "-122.34414"],
    ["47.60832", "-122.34424"],
    ["47.60832", "-122.34422"],
    ["47.60836", "-122.34452"],
    ["47.60835", "-122.34473"],
    ["47.60834", "-122.34476"],
    ["47.60836", "-122.34489"],
    ["47.60835", "-122.3453"],
    ["47.60834", "-122.34531"],
    ["47.60835", "-122.34524"],
    ["47.60833", "-122.34494"],
    ["47.60835", "-122.34434"],
    ["47.60834", "-122.34423"],
    ["47.60838", "-122.34421"],
    ["47.60848", "-122.34421"],
    ["47.60871", "-122.34441"],
    ["47.60908", "-122.345"],
    ["47.60912", "-122.34499"],
    ["47.6092", "-122.34487"],
    ["47.60929", "-122.345"],
    ["47.60941", "-122.34497"],
    ["47.60945", "-122.34503"],
    ["47.60951", "-122.34516"],
    ["47.60949", "-122.34519"],
    ["47.60946", "-122.34518"],
    ["47.60946", "-122.34521"],
    ["47.60949", "-122.34515"],
    ["47.60957", "-122.34522"],
    ["47.60965", "-122.34537"],
    ["47.61019", "-122.34622"],
    ["47.6103", "-122.34645"],
    ["47.61084", "-122.34737"],
    ["47.61094", "-122.3476"],
    ["47.61135", "-122.34823"],
    ["47.61143", "-122.34841"],
    ["47.61148", "-122.34862"],
    ["47.61158", "-122.34876"],
    ["47.61184", "-122.3493"],
    ["47.6121", "-122.34973"],
    ["47.61214", "-122.34995"],
    ["47.6124", "-122.35031"],
    ["47.6129", "-122.35121"],
    ["47.61296", "-122.35138"],
    ["47.61324", "-122.35189"],
    ["47.61338", "-122.35209"],
    ["47.61343", "-122.35206"],
    ["47.61397", "-122.35132"],
    ["47.61414", "-122.35124"],
    ["47.61422", "-122.35118"],
    ["47.61428", "-122.35099"],
    ["47.61446", "-122.35078"],
    ["47.61446", "-122.35055"],
    ["47.6147", "-122.3504"],
    ["47.61482", "-122.35028"],
    ["47.61486", "-122.35022"],
    ["47.61488", "-122.35013"],
    ["47.61496", "-122.35"],
    ["47.61514", "-122.34982"],
    ["47.61515", "-122.34974"],
    ["47.61518", "-122.3497"],
    ["47.61526", "-122.34973"],
    ["47.61523", "-122.34969"],
    ["47.61525", "-122.34962"],
    ["47.61539", "-122.34956"],
    ["47.61558", "-122.34935"],
    ["47.61561", "-122.34929"],
    ["47.61577", "-122.34916"],
    ["47.61589", "-122.34894"],
    ["47.61588", "-122.34892"],
    ["47.6159", "-122.34895"],
    ["47.61596", "-122.34883"],
    ["47.61596", "-122.34899"],
    ["47.61617", "-122.34929"],
    ["47.61652", "-122.34966"],
    ["47.61652", "-122.34968"],
    ["47.61649", "-122.34967"],
    ["47.6165", "-122.34971"],
    ["47.61689", "-122.35036"],
    ["47.61709", "-122.35079"],
    ["47.61744", "-122.35131"],
    ["47.61753", "-122.35153"],
    ["47.61758", "-122.35159"],
    ["47.61757", "-122.35167"],
    ["47.61761", "-122.35169"],
    ["47.61773", "-122.35154"],
    ["47.61781", "-122.3514"],
    ["47.61816", "-122.35111"],
    ["47.61822", "-122.35093"],
    ["47.61817", "-122.35088"],
    ["47.61818", "-122.35095"],
    ["47.61828", "-122.35076"],
    ["47.61847", "-122.35048"],
    ["47.61876", "-122.35011"],
    ["47.61907", "-122.34963"],
    ["47.61933", "-122.34931"],
    ["47.61948", "-122.34908"],
    ["47.61958", "-122.34899"],
    ["47.61987", "-122.34865"],
    ["47.61989", "-122.34868"],
    ["47.61989", "-122.34863"],
    ["47.62008", "-122.34848"],
    ["47.62017", "-122.34837"],
    ["47.62039", "-122.34804"],
    ["47.62051", "-122.34789"],
    ["47.62053", "-122.34775"],
    ["47.62057", "-122.3477"],
    ["47.62081", "-122.34759"],
    ["47.62088", "-122.34744"],
    ["47.62091", "-122.34727"],
    ["47.62089", "-122.34681"],
    ["47.62094", "-122.34661"],
    ["47.62096", "-122.34635"],
    ["47.62094", "-122.34587"],
    ["47.62098", "-122.3455"],
    ["47.62097", "-122.34511"],
    ["47.62096", "-122.34501"],
    ["47.6209", "-122.34486"],
    ["47.62089", "-122.3447"],
    ["47.62092", "-122.34418"],
    ["47.6209", "-122.344"],
    ["47.62083", "-122.34397"],
    ["47.62076", "-122.34388"],
    ["47.62079", "-122.34368"],
    ["47.62085", "-122.34357"],
    ["47.6209", "-122.34339"],
    ["47.62099", "-122.34278"],
    ["47.621", "-122.34256"],
    ["47.62098", "-122.34248"],
    ["47.62089", "-122.34242"],
    ["47.62086", "-122.34237"],
    ["47.62083", "-122.34224"],
    ["47.62087", "-122.34221"],
    ["47.62094", "-122.34227"],
    ["47.62109", "-122.34232"],
    ["47.62113", "-122.34229"],
    ["47.62137", "-122.34226"],
    ["47.62202", "-122.34253"],
    ["47.62227", "-122.34245"],
    ["47.62247", "-122.34246"],
    ["47.62262", "-122.34241"],
    ["47.62317", "-122.34256"],
    ["47.62336", "-122.34255"],
    ["47.6236", "-122.34263"],
    ["47.62381", "-122.34265"],
    ["47.62397", "-122.34242"],
    ["47.62405", "-122.34237"],
    ["47.6243", "-122.34231"],
    ["47.62428", "-122.34236"],
    ["47.6253", "-122.34233"],
    ["47.62535", "-122.34236"],
    ["47.62532", "-122.34252"],
    ["47.62531", "-122.34247"],
    ["47.62534", "-122.34245"],
    ["47.62547", "-122.34244"],
    ["47.62574", "-122.34229"],
    ["47.62613", "-122.3424"],
    ["47.62668", "-122.34243"],
    ["47.62687", "-122.34249"],
    ["47.62712", "-122.34244"],
    ["47.62774", "-122.34242"],
    ["47.62811", "-122.34244"],
    ["47.62833", "-122.3424"],
    ["47.62861", "-122.3424"],
    ["47.62879", "-122.34229"],
    ["47.62903", "-122.34232"],
    ["47.62923", "-122.34244"],
    ["47.62936", "-122.34245"],
    ["47.62953", "-122.34235"],
    ["47.62975", "-122.34229"],
    ["47.62996", "-122.34234"],
    ["47.62997", "-122.34231"],
  ].map((coord) => [parseFloat(coord[1]), parseFloat(coord[0])]),
];


export default function MapWithPolylines(props) {
  const polylines = [props.polyline.map((coord) => [parseFloat(coord[1]), parseFloat(coord[0])])]
  const [viewport, setViewport] = useState({
    latitude: polylines[0][0][1],
    longitude: polylines[0][0][0],
    zoom: 12,
  });

  // Create GeoJSON for the polylines
  const geojsonData = {
    type: "FeatureCollection",
    features: polylines.map((line) => {
      return {
        type: "Feature",
        geometry: {
          type: "LineString",
          coordinates: line,
        },
      };
    }),
  };

  return (
    <Map
      initialViewState={viewport}
      style={{ width: "100%", height: "40vh", display: 'flex', alignItems:'center', justifyContent: 'center', margin:'0 auto' }}
      mapStyle="mapbox://styles/mapbox/navigation-night-v1"
      mapboxAccessToken={mapboxApi}
      onMove={(evt) => setViewport(evt.viewState)}
    >
      {/* Add the polylines as a source */}
      <Source id="polylineSource" type="geojson" data={geojsonData}>
        <Layer
          id="polylineLayer"
          type="line"
          paint={{
            "line-color": "#d50000",
            "line-width": 3,
          }}
        />
      </Source>
    </Map>
  );
}
